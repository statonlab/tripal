<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.15">
  <compounddef id="da/d51/tripal__ws_8api_8inc" kind="file" language="PHP">
    <compoundname>tripal_ws.api.inc</compoundname>
      <sectiondef kind="func">
      <memberdef kind="function" id="da/d51/tripal__ws_8api_8inc_1a5a769b4e94e099cdffac811d76026570" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>_tripal_report_ws_error</definition>
        <argsstring>($data)</argsstring>
        <name>_tripal_report_ws_error</name>
        <param>
          <declname>$data</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>A helper function for reporting an error when retrieving remote content.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$data</parametername>
</parameternamelist>
<parameterdescription>
<para>A data array containing at a minimum the &apos;error&apos; key containing the error message. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="306" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="306" bodyend="311"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>_tripal_update_remote_entity_field</definition>
        <argsstring>($field_data, $context, $depth=0)</argsstring>
        <name>_tripal_update_remote_entity_field</name>
        <param>
          <declname>$field_data</declname>
        </param>
        <param>
          <declname>$context</declname>
        </param>
        <param>
          <declname>$depth</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>A helper function for the tripal_get_remote_entity() function.</para><para>This function converts the field&apos;s key elements to their vocabulary term accessions.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$field_data</parametername>
</parameternamelist>
<parameterdescription>
<para>The field array as returned by web services. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$context</parametername>
</parameternamelist>
<parameterdescription>
<para>The web service JSON-LD context for the bundle to which the field belongs. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="706" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="706" bodyend="748"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga67aefbd45d52c779ca53e5248e2cb002" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>hook_tripal_ws_value</definition>
        <argsstring>(&amp;$items, $field, $instance)</argsstring>
        <name>hook_tripal_ws_value</name>
        <param>
          <type>&amp;</type>
          <declname>$items</declname>
        </param>
        <param>
          <declname>$field</declname>
        </param>
        <param>
          <declname>$instance</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Adjust the values of a field for display in web services.</para><para>This hook should be used sparingly. It is meant primarily to adjust 3rd Party (non Tripal) fields so that they work with web services. The caller should adjust the $items array as needed. This change only affects the value displayed in web services. Web services expect that every field have a &apos;value&apos; element for each of the items. If a field for some reason does not have a &apos;value&apos; element then this hook will allow setting of that element.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$items</parametername>
</parameternamelist>
<parameterdescription>
<para>The list of items for the field. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field</parametername>
</parameternamelist>
<parameterdescription>
<para>The field array. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$instance</parametername>
</parameternamelist>
<parameterdescription>
<para>The field instance array. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="40" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="40" bodyend="50"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga1f675c5d12b2693a96e273266d94389a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_add_site</definition>
        <argsstring>($name, $url, $version, $description)</argsstring>
        <name>tripal_add_site</name>
        <param>
          <declname>$name</declname>
        </param>
        <param>
          <declname>$url</declname>
        </param>
        <param>
          <declname>$version</declname>
        </param>
        <param>
          <declname>$description</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Adds a new site to the web services table.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$name</parametername>
</parameternamelist>
<parameterdescription>
<para>Name of site to be included. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$url</parametername>
</parameternamelist>
<parameterdescription>
<para>URL of site to be added. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$version</parametername>
</parameternamelist>
<parameterdescription>
<para>Version of the API being used. default to 1 </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$description</parametername>
</parameternamelist>
<parameterdescription>
<para>A description of the site and any additional info that would be helpful for admins.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>TRUE if the site is successfully added, FALSE otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="130" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="130" bodyend="173"/>
      </memberdef>
      <memberdef kind="function" id="da/d51/tripal__ws_8api_8inc_1af46434979b38de9e097eb0f70631feb3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_build_remote_content_url</definition>
        <argsstring>($remote_site, $path=&apos;&apos;, $query=&apos;&apos;)</argsstring>
        <name>tripal_build_remote_content_url</name>
        <param>
          <declname>$remote_site</declname>
        </param>
        <param>
          <declname>$path</declname>
          <defval>&apos;&apos;</defval>
        </param>
        <param>
          <declname>$query</declname>
          <defval>&apos;&apos;</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Constructs a URL for a remote Tripal web service.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$remote_site</parametername>
</parameternamelist>
<parameterdescription>
<para>A remote Tripal site object. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$path</parametername>
</parameternamelist>
<parameterdescription>
<para>The web service path for the content (excluding &apos;web-servcies/vX.x/content&apos;). To retrieve the full content listing leave this paramter empty. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$query</parametername>
</parameternamelist>
<parameterdescription>
<para>An query string to appear after the ? in a URL.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><linebreak/>
 The full URL within the content service. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="212" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="212" bodyend="225"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga423162ba2093c4eaa263480c56d1b07a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_clear_remote_cache</definition>
        <argsstring>($site_id)</argsstring>
        <name>tripal_clear_remote_cache</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Clears the cached remote site documentation and context.</para><para>When querying a remote website, the site&apos;s API documenation and page context is cached to make re-use of that information easier in the future. This function can be used to clear those caches.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="398" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="398" bodyend="404"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_API_doc</definition>
        <argsstring>($site_id)</argsstring>
        <name>tripal_get_remote_API_doc</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieves the API documentation for a remote Tripal web service.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The vocabulary of a remote Tripal web service, or FALSE if an error occured. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="416" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="416" bodyend="479"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaa2730a7f144bf318af7d3c9893a57f54" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_content</definition>
        <argsstring>($site_id, $path=&apos;&apos;, $query=&apos;&apos;)</argsstring>
        <name>tripal_get_remote_content</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$path</declname>
          <defval>&apos;&apos;</defval>
        </param>
        <param>
          <declname>$query</declname>
          <defval>&apos;&apos;</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Makes a request to the &quot;content&quot; service of a remote Tripal web site.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$path</parametername>
</parameternamelist>
<parameterdescription>
<para>The web service path for the content (excluding &apos;web-servcies/vX.x/content&apos;). To retrieve the full content listing leave this paramter empty. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$query</parametername>
</parameternamelist>
<parameterdescription>
<para>An query string to appear after the ? in a URL.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The JSON response formatted in a PHP array or FALSE if a problem occured. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="244" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="244" bodyend="297"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gafa217795f272e54f81654828a0506234" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_content_context</definition>
        <argsstring>($site_id, $context_url, $bundle_accession, $field_accession=&apos;&apos;)</argsstring>
        <name>tripal_get_remote_content_context</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$context_url</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_accession</declname>
          <defval>&apos;&apos;</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieves the JSON-LD context for a bundle or field on a remote Tripal site.</para><para>The $site_id, $bundle_accession and $field_accession variables are not needed to retrieve the context, but are used for caching the context to make subsequent calls execute faster. This function is meant to be used only for the &apos;content&apos; service provided by Tripal.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$context_url</parametername>
</parameternamelist>
<parameterdescription>
<para>The Full URL for the context file on the remote Tripal site. This URL can be found in the &apos;&apos; key of any response from a remote Tripal web services call. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the property (i.e. field) of the Class (i.e. content type). </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The JSON-LD context mapping array. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="380" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="380" bodyend="384"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga71b6139da4c605252b6c539215d072f9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_content_doc</definition>
        <argsstring>($site_id, $bundle_accession)</argsstring>
        <name>tripal_get_remote_content_doc</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retreive the content type information from a remote Tripal site.</para><para>The array returned is equivalent to the Hydra Vocabulary &quot;supportedClass&quot; stanza.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A PHP array corresponding to the Hydra Class stanza (i.e. a content type). Returns NULL if the class ID cannot be found. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="857" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="857" bodyend="871"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga7e5d7b4d8e3e2b41352639f2953e64c5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_context</definition>
        <argsstring>($context_url, $cache_id)</argsstring>
        <name>tripal_get_remote_context</name>
        <param>
          <declname>$context_url</declname>
        </param>
        <param>
          <declname>$cache_id</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieves the JSON-LD context for any remote Tripal web service.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$context_url</parametername>
</parameternamelist>
<parameterdescription>
<para>The Full URL for the context file on the remote Tripal site. This URL can be found in the &apos;&apos; key of any response from a remote Tripal web services call. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$cache_id</parametername>
</parameternamelist>
<parameterdescription>
<para>A unique ID for caching of this context result to speed furture queries. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The JSON-LD context mapping array, or FALSE if the context could not be retrieved. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="329" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="329" bodyend="353"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gacce8c27bef223dc195354a329e39d640" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_field_doc</definition>
        <argsstring>($site_id, $bundle_accession, $field_accession)</argsstring>
        <name>tripal_get_remote_field_doc</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_accession</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieves the field information for a content type from a remote Tripal site.</para><para>The array returned is equivalent to the Hydra Vocabulary &quot;supportedProperty&quot; stanza that belongs to a Hydra Class (content type).</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the property (i.e. field) of the Class (i.e. content type). </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A PHP array corresponding to the Hydra property stanza (field) that belongs to the given Class (i.e. a content type). Retruns NULL if the property cannot be found. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="894" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="894" bodyend="907"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaa4a572e98c30c3596c6dec4afd6a4811" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_field_formatters</definition>
        <argsstring>($site_id, $bundle_accession, $field_accession)</argsstring>
        <name>tripal_get_remote_field_formatters</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_accession</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieves the list of download formatters for a remote field.</para><para>All Tripal fields support the abilty for inclusion in files that can downloaded. This function is used to identify what formatters these fields are appropriate for. If those download formatter classes exist on this site then the field can be used with that formatter.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the property (i.e. field) of the Class (i.e. content type). </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An array of field downloader class names that are compoatible with the field and which exist on this site. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="932" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="932" bodyend="950"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaf420ee503552d259852ba61f1123ea83" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_field_info</definition>
        <argsstring>($site_id, $bundle_accession, $field_accession)</argsstring>
        <name>tripal_get_remote_field_info</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_accession</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Behaves similar to the field_info_field() function but for remote fields.</para><para>Returns a &quot;fake&quot; field info array for fields attached to content types on remote Tripal sites.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the property (i.e. field) of the Class (i.e. content type). </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An array similar to that returned by the field_info_field function of Drupal for local fields. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="770" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="770" bodyend="790"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga882c3206ab764a16d99b034b35050323" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_remote_field_instance_info</definition>
        <argsstring>($site_id, $bundle_accession, $field_accession)</argsstring>
        <name>tripal_get_remote_field_instance_info</name>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_accession</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Behaves similar to the field_info_instance() function but for remote fields.</para><para>Returns a &quot;fake&quot; instance info array for fields attached to content types on remote Tripal sites.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the property (i.e. field) of the Class (i.e. content type). </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An array similar to that returned by the field_info_instance function of Drupal for local fields. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="812" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="812" bodyend="837"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1ga1b303b60ce0c548c2da95a7b6fbde04b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_get_web_services</definition>
        <argsstring>()</argsstring>
        <name>tripal_get_web_services</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Retrieves a list of <ref refid="d3/d58/classTripalWebService" kindref="compound">TripalWebService</ref> implementations.</para><para>The <ref refid="d3/d58/classTripalWebService" kindref="compound">TripalWebService</ref> classes can be added by a site developer that wishes to create a new Tripal compatible web serivce. The class file should be placed in the [module]/includes/TripalWebService directory. Tripal will support any service as long as it is in this directory and extends the <ref refid="d3/d58/classTripalWebService" kindref="compound">TripalWebService</ref> class.</para><para><simplesect kind="return"><para>A list of <ref refid="d3/d58/classTripalWebService" kindref="compound">TripalWebService</ref> names. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="66" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="66" bodyend="84"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gad01c76a2bb50c6438f53388abf4bae64" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_load_include_web_service_class</definition>
        <argsstring>($class)</argsstring>
        <name>tripal_load_include_web_service_class</name>
        <param>
          <declname>$class</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Loads the <ref refid="d3/d58/classTripalWebService" kindref="compound">TripalWebService</ref> class file into scope.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$class</parametername>
</parameternamelist>
<parameterdescription>
<para>The <ref refid="d3/d58/classTripalWebService" kindref="compound">TripalWebService</ref> class to include.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>TRUE if the field type class file was found, FALSE otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="97" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="97" bodyend="110"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_load_remote_entities</definition>
        <argsstring>($remote_entity_ids, $site_id, $bundle_accession, $field_ids)</argsstring>
        <name>tripal_load_remote_entities</name>
        <param>
          <declname>$remote_entity_ids</declname>
        </param>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_ids</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Queries a remote site for an array of bulk entity ids.</para><para>This function returns an array of &quot;fake&quot; entities containing values for fields specified.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$remote_entity_ids</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of the remote ids. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_ids</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accessions for the fields available on the remote content type. Any remote fields that matches these IDs will be added to the entity returned. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An array of fake entity objects where the key is the entity_id and the value is the object. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="504" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="504" bodyend="573"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gaa7baa2401471aab9ee0181e9f093b13a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_load_remote_entity</definition>
        <argsstring>($remote_entity_id, $site_id, $bundle_accession, $field_ids)</argsstring>
        <name>tripal_load_remote_entity</name>
        <param>
          <declname>$remote_entity_id</declname>
        </param>
        <param>
          <declname>$site_id</declname>
        </param>
        <param>
          <declname>$bundle_accession</declname>
        </param>
        <param>
          <declname>$field_ids</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Queries a remote site for an entity.</para><para>This function returns a &quot;fake&quot; entity containing values for all fields specified.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$remote_entity_id</parametername>
</parameternamelist>
<parameterdescription>
<para>A remote entity ID. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$site_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric site ID for the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$bundle_accession</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accession for the content type on the remote Tripal site. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>$field_ids</parametername>
</parameternamelist>
<parameterdescription>
<para>The controlled vocabulary term accessions for the fields available on the remote content type. Any remote fields that matches these IDs will be added to the entity returned. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A fake entity object. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="597" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="597" bodyend="691"/>
      </memberdef>
      <memberdef kind="function" id="d0/d59/group__tripal__ws__api_1gac8f2b660e1b7934464e4017d3caf2c90" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>tripal_remove_site</definition>
        <argsstring>($record_id)</argsstring>
        <name>tripal_remove_site</name>
        <param>
          <declname>$record_id</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Remove a site from the web services table.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>$record_id</parametername>
</parameternamelist>
<parameterdescription>
<para>ID of the record to be deleted.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>TRUE if the record was successfully deleted, FALSE otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tripal_ws/api/tripal_ws.api.inc" line="186" column="1" bodyfile="tripal_ws/api/tripal_ws.api.inc" bodystart="186" bodyend="195"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para>This file provides the Tripal Web Services API: a set of functions for interacting with the Tripal Web Services. </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal">&lt;?php</highlight></codeline>
<codeline lineno="40" refid="d0/d59/group__tripal__ws__api_1ga67aefbd45d52c779ca53e5248e2cb002" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1ga67aefbd45d52c779ca53e5248e2cb002" kindref="member">hook_tripal_ws_value</ref>(&amp;$items,<sp/>$field,<sp/>$instance)<sp/>{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>image<sp/>module<sp/>doesn&apos;t<sp/>properly<sp/>set<sp/>the<sp/>&apos;value&apos;<sp/>field,<sp/>so<sp/>we&apos;ll<sp/>do<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>here.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($field[</highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;image&apos;</highlight><highlight class="normal"><sp/>and<sp/>$field[</highlight><highlight class="stringliteral">&apos;module&apos;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;image&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($items<sp/>as<sp/>$delta<sp/>=&gt;<sp/>$details)<sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($items[$delta]<sp/>and<sp/>array_key_exists(</highlight><highlight class="stringliteral">&apos;uri&apos;</highlight><highlight class="normal">,<sp/>$items[$delta]))<sp/>{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$items[$delta][</highlight><highlight class="stringliteral">&apos;value&apos;</highlight><highlight class="normal">][</highlight><highlight class="stringliteral">&apos;schema:url&apos;</highlight><highlight class="normal">]<sp/>=<sp/>file_create_url($items[$delta][</highlight><highlight class="stringliteral">&apos;uri&apos;</highlight><highlight class="normal">]);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="50"><highlight class="normal">}</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="d0/d59/group__tripal__ws__api_1ga1b303b60ce0c548c2da95a7b6fbde04b" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1ga1b303b60ce0c548c2da95a7b6fbde04b" kindref="member">tripal_get_web_services</ref>()<sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/>$services<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/>$modules<sp/>=<sp/>module_list(TRUE);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($modules<sp/>as<sp/>$module)<sp/>{</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>all<sp/>of<sp/>the<sp/>files<sp/>in<sp/>the<sp/>tripal_chado/includes/fields<sp/>directory.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>$service_path<sp/>=<sp/>drupal_get_path(</highlight><highlight class="stringliteral">&apos;module&apos;</highlight><highlight class="normal">,<sp/>$module)<sp/>.<sp/></highlight><highlight class="stringliteral">&apos;/includes/TripalWebService&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>$service_files<sp/>=<sp/>file_scan_directory($service_path,<sp/></highlight><highlight class="stringliteral">&apos;/.inc$/&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>through<sp/>the<sp/>fields,<sp/>include<sp/>the<sp/>file<sp/>and<sp/>run<sp/>the<sp/>info<sp/>function.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($service_files<sp/>as<sp/>$file)<sp/>{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$class<sp/>=<sp/>$file-&gt;name;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>module_load_include(</highlight><highlight class="stringliteral">&apos;inc&apos;</highlight><highlight class="normal">,<sp/>$module,<sp/></highlight><highlight class="stringliteral">&apos;includes/TripalWebService/&apos;</highlight><highlight class="normal"><sp/>.<sp/>$class);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(class_exists($class)<sp/>and<sp/>is_subclass_of($class,<sp/></highlight><highlight class="stringliteral">&apos;TripalWebService&apos;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$services[]<sp/>=<sp/>$class;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$services;</highlight></codeline>
<codeline lineno="84"><highlight class="normal">}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="d0/d59/group__tripal__ws__api_1gad01c76a2bb50c6438f53388abf4bae64" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1gad01c76a2bb50c6438f53388abf4bae64" kindref="member">tripal_load_include_web_service_class</ref>($class)<sp/>{</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/>$modules<sp/>=<sp/>module_list(TRUE);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($modules<sp/>as<sp/>$module)<sp/>{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>$file_path<sp/>=<sp/>realpath(</highlight><highlight class="stringliteral">&quot;.&quot;</highlight><highlight class="normal">)<sp/>.<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>.<sp/>drupal_get_path(</highlight><highlight class="stringliteral">&apos;module&apos;</highlight><highlight class="normal">,<sp/>$module)<sp/>.<sp/></highlight><highlight class="stringliteral">&apos;/includes/TripalWebService/&apos;</highlight><highlight class="normal"><sp/>.<sp/>$class<sp/>.<sp/></highlight><highlight class="stringliteral">&apos;.inc&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(file_exists($file_path))<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>module_load_include(</highlight><highlight class="stringliteral">&apos;inc&apos;</highlight><highlight class="normal">,<sp/>$module,<sp/></highlight><highlight class="stringliteral">&apos;includes/TripalWebService/&apos;</highlight><highlight class="normal"><sp/>.<sp/>$class);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(class_exists($class))<sp/>{</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>TRUE;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FALSE;</highlight></codeline>
<codeline lineno="110"><highlight class="normal">}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="d0/d59/group__tripal__ws__api_1ga1f675c5d12b2693a96e273266d94389a" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1ga1f675c5d12b2693a96e273266d94389a" kindref="member">tripal_add_site</ref>($name,<sp/>$url,<sp/>$version,<sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1a87b032cba06009e3467abf1c8018d960" kindref="member">$description</ref>)<sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/>$check_url<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/>$check_name<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/>$write_to_db<sp/>=<sp/>TRUE;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>When<sp/>inserting<sp/>a<sp/>record.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/>$check_url<sp/>=</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>db_select(</highlight><highlight class="stringliteral">&apos;tripal_sites&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ts&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;fields(</highlight><highlight class="stringliteral">&apos;ts&apos;</highlight><highlight class="normal">,<sp/>array(</highlight><highlight class="stringliteral">&apos;id&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;condition(</highlight><highlight class="stringliteral">&apos;url&apos;</highlight><highlight class="normal">,<sp/>$url)</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;condition(</highlight><highlight class="stringliteral">&apos;version&apos;</highlight><highlight class="normal">,<sp/>$version)</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;execute()</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;fetchField();</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/>$check_name<sp/>=</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>db_select(</highlight><highlight class="stringliteral">&apos;tripal_sites&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ts&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;fields(</highlight><highlight class="stringliteral">&apos;ts&apos;</highlight><highlight class="normal">,<sp/>array(</highlight><highlight class="stringliteral">&apos;id&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;condition(</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">,<sp/>$name)</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;execute()</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;fetchField();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($check_url)<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>drupal_set_message(t(</highlight><highlight class="stringliteral">&apos;The<sp/>URL<sp/>and<sp/>version<sp/>is<sp/>used<sp/>by<sp/>another<sp/>site.&apos;</highlight><highlight class="normal">),<sp/></highlight><highlight class="stringliteral">&apos;error&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>$write_to_db<sp/>=<sp/>FALSE;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($check_name)<sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>drupal_set_message(t(</highlight><highlight class="stringliteral">&apos;The<sp/>name<sp/>is<sp/>used<sp/>by<sp/>another<sp/>site.&apos;</highlight><highlight class="normal">),<sp/></highlight><highlight class="stringliteral">&apos;error&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>$write_to_db<sp/>=<sp/>FALSE;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($write_to_db<sp/>===<sp/>TRUE)<sp/>{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>db_insert(</highlight><highlight class="stringliteral">&apos;tripal_sites&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>-&gt;fields(array(</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$name,</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;url&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$url,</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;version&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$version,</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;description&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1a87b032cba06009e3467abf1c8018d960" kindref="member">$description</ref></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>))</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;execute();</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>drupal_set_message(t(</highlight><highlight class="stringliteral">&apos;Tripal<sp/>site<sp/>\&apos;&apos;</highlight><highlight class="normal"><sp/>.<sp/>$name<sp/>.<sp/></highlight><highlight class="charliteral">&apos;\&apos;</highlight><highlight class="normal"><sp/>has<sp/>been<sp/>added.</highlight><highlight class="stringliteral">&apos;));</highlight></codeline>
<codeline lineno="169"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>$write_to_db;</highlight></codeline>
<codeline lineno="170"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="171"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="172"><highlight class="stringliteral"><sp/><sp/>return<sp/>$write_to_db;</highlight></codeline>
<codeline lineno="173"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="174"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="186" refid="d0/d59/group__tripal__ws__api_1gac8f2b660e1b7934464e4017d3caf2c90" refkind="member"><highlight class="stringliteral">function<sp/>tripal_remove_site($record_id)<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="stringliteral"><sp/><sp/>if<sp/>($record_id)<sp/>{</highlight></codeline>
<codeline lineno="188"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>db_delete(&apos;</highlight><highlight class="normal">tripal_sites</highlight><highlight class="stringliteral">&apos;)</highlight></codeline>
<codeline lineno="189"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;condition(&apos;</highlight><highlight class="keywordtype">id</highlight><highlight class="stringliteral">&apos;,<sp/>$record_id)</highlight></codeline>
<codeline lineno="190"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>-&gt;execute();</highlight></codeline>
<codeline lineno="191"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>drupal_set_message(&apos;</highlight><highlight class="normal">The<sp/>Tripal<sp/>site<sp/>\</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"><sp/>.<sp/>$record_id<sp/>.<sp/></highlight><highlight class="charliteral">&apos;\&apos;</highlight><highlight class="normal"><sp/>has<sp/>been<sp/>removed.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="192"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>TRUE;</highlight></codeline>
<codeline lineno="193"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="stringliteral"><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline lineno="195"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="196"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="212" refid="da/d51/tripal__ws_8api_8inc_1af46434979b38de9e097eb0f70631feb3" refkind="member"><highlight class="stringliteral">function<sp/>tripal_build_remote_content_url($remote_site,<sp/>$path<sp/>=<sp/>&apos;</highlight><highlight class="stringliteral">&apos;,<sp/>$query<sp/>=<sp/>&apos;</highlight><highlight class="stringliteral">&apos;)<sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="stringliteral"><sp/><sp/>//<sp/>Build<sp/>the<sp/>URL<sp/>to<sp/>the<sp/>remote<sp/>web<sp/>services.</highlight></codeline>
<codeline lineno="214"><highlight class="stringliteral"><sp/><sp/>$ws_version<sp/>=<sp/>$remote_site-&gt;version;</highlight></codeline>
<codeline lineno="215"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>=<sp/>$remote_site-&gt;url;</highlight></codeline>
<codeline lineno="216"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>=<sp/>trim($ws_url,<sp/>&apos;</highlight><highlight class="normal">/</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="217"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>.=<sp/>&apos;</highlight><highlight class="normal">/web-services/content/</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$ws_version<sp/>.<sp/>&apos;</highlight><highlight class="normal">/</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$path;</highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"><sp/><sp/></highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"><sp/><sp/>//<sp/>Build<sp/>the<sp/>Query<sp/>and<sp/>make<sp/>and<sp/>substitions<sp/>needed.</highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/>if<sp/>($query)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>$ws_url<sp/>=<sp/>$ws_url<sp/>.<sp/>&apos;</highlight><highlight class="normal">?</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$query;</highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"><sp/><sp/></highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/>return<sp/>$ws_url;</highlight></codeline>
<codeline lineno="225"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="226"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="244" refid="d0/d59/group__tripal__ws__api_1gaa2730a7f144bf318af7d3c9893a57f54" refkind="member"><highlight class="stringliteral">function<sp/>tripal_get_remote_content($site_id,<sp/>$path<sp/>=<sp/>&apos;</highlight><highlight class="stringliteral">&apos;,<sp/>$query<sp/>=<sp/>&apos;</highlight><highlight class="stringliteral">&apos;)<sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="246"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$site_id)<sp/>{</highlight></codeline>
<codeline lineno="247"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>a<sp/>numeric<sp/>site<sp/>ID<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa2730a7f144bf318af7d3c9893a57f54" kindref="member">tripal_get_remote_content</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="248"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="249"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="250"><highlight class="stringliteral"><sp/><sp/>//<sp/>Fetch<sp/>the<sp/>record<sp/>for<sp/>this<sp/>site<sp/>id.</highlight></codeline>
<codeline lineno="251"><highlight class="stringliteral"><sp/><sp/>$remote_site<sp/>=<sp/>db_select(&apos;</highlight><highlight class="normal">tripal_sites</highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal">ts</highlight><highlight class="stringliteral">&apos;)</highlight></codeline>
<codeline lineno="252"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;fields(&apos;</highlight><highlight class="normal">ts</highlight><highlight class="stringliteral">&apos;)</highlight></codeline>
<codeline lineno="253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;condition(&apos;</highlight><highlight class="normal">ts.id</highlight><highlight class="stringliteral">&apos;,<sp/>$site_id)</highlight></codeline>
<codeline lineno="254"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;execute()</highlight></codeline>
<codeline lineno="255"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;fetchObject();</highlight></codeline>
<codeline lineno="256"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="257"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$remote_site)<sp/>{</highlight></codeline>
<codeline lineno="258"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>$data<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="259"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>t(&apos;</highlight><highlight class="normal">Could<sp/>not<sp/>find<sp/>a<sp/>remote<sp/>tripal<sp/>site<sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>the<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>provided:<sp/>!</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;,</highlight></codeline>
<codeline lineno="260"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array(&apos;</highlight><highlight class="normal">!</highlight><highlight class="keywordtype">id</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$site_id))</highlight></codeline>
<codeline lineno="261"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>];</highlight></codeline>
<codeline lineno="262"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>_tripal_report_ws_error($data);</highlight></codeline>
<codeline lineno="263"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>$data;</highlight></codeline>
<codeline lineno="264"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="stringliteral"><sp/><sp/></highlight></codeline>
<codeline lineno="266"><highlight class="stringliteral"><sp/><sp/>//<sp/>Make<sp/>the<sp/>remote<sp/>query.</highlight></codeline>
<codeline lineno="267"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>=<sp/>tripal_build_remote_content_url($remote_site,<sp/>$path,<sp/>$query);</highlight></codeline>
<codeline lineno="268"><highlight class="stringliteral"><sp/><sp/>$data<sp/>=<sp/>drupal_http_request($ws_url);</highlight></codeline>
<codeline lineno="269"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$data)<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>$data<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="271"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>t(&apos;</highlight><highlight class="normal">Could<sp/>not<sp/>connect<sp/>to<sp/>the<sp/>remote<sp/>web<sp/>service<sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>the<sp/>url:<sp/>!url</highlight><highlight class="stringliteral">&apos;,</highlight></codeline>
<codeline lineno="272"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&apos;</highlight><highlight class="normal">!url</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$ws_url])</highlight></codeline>
<codeline lineno="273"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>];</highlight></codeline>
<codeline lineno="274"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>_tripal_report_ws_error($data);</highlight></codeline>
<codeline lineno="275"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>$data;</highlight></codeline>
<codeline lineno="276"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="277"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="278"><highlight class="stringliteral"><sp/><sp/>//<sp/>If<sp/>the<sp/>data<sp/>object<sp/>has<sp/>an<sp/>error<sp/>then<sp/>this<sp/>is<sp/>some<sp/>sort<sp/>of</highlight></codeline>
<codeline lineno="279"><highlight class="stringliteral"><sp/><sp/>//<sp/>connection<sp/>error<sp/>(not<sp/>a<sp/>Tripal<sp/>web<sp/>servcies<sp/>error).</highlight></codeline>
<codeline lineno="280"><highlight class="stringliteral"><sp/><sp/>if<sp/>(property_exists($data,<sp/>&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;))<sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>$data<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="282"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$data-&gt;error</highlight></codeline>
<codeline lineno="283"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>];</highlight></codeline>
<codeline lineno="284"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>_tripal_report_ws_error($data);</highlight></codeline>
<codeline lineno="285"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>$data;</highlight></codeline>
<codeline lineno="286"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="287"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="288"><highlight class="stringliteral"><sp/><sp/>//<sp/>We<sp/>got<sp/>a<sp/>response,<sp/>so<sp/>convert<sp/>it<sp/>to<sp/>a<sp/>PHP<sp/>array.</highlight></codeline>
<codeline lineno="289"><highlight class="stringliteral"><sp/><sp/>$data<sp/>=<sp/>drupal_json_decode($data-&gt;data);</highlight></codeline>
<codeline lineno="290"><highlight class="stringliteral"><sp/><sp/></highlight></codeline>
<codeline lineno="291"><highlight class="stringliteral"><sp/><sp/>//<sp/>Check<sp/>if<sp/>there<sp/>was<sp/>a<sp/>Tripal<sp/>Web<sp/>Services<sp/>error.</highlight></codeline>
<codeline lineno="292"><highlight class="stringliteral"><sp/><sp/>if<sp/>(array_key_exists(&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;,<sp/>$data))<sp/>{</highlight></codeline>
<codeline lineno="293"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>_tripal_report_ws_error($data);</highlight></codeline>
<codeline lineno="294"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="295"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="296"><highlight class="stringliteral"><sp/><sp/>return<sp/>$data;</highlight></codeline>
<codeline lineno="297"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="298"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="306" refid="da/d51/tripal__ws_8api_8inc_1a5a769b4e94e099cdffac811d76026570" refkind="member"><highlight class="stringliteral">function<sp/>_tripal_report_ws_error($data)<sp/>{<sp/><sp/></highlight></codeline>
<codeline lineno="307"><highlight class="stringliteral"><sp/><sp/>$error<sp/>=<sp/>&apos;</highlight><highlight class="normal">&lt;/pre&gt;</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>print_r($data[&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;],<sp/>TRUE)<sp/>.<sp/>&apos;</highlight><highlight class="normal">&lt;/pre&gt;</highlight><highlight class="stringliteral">&apos;;</highlight></codeline>
<codeline lineno="308"><highlight class="stringliteral"><sp/><sp/>tripal_report_error(&apos;</highlight><highlight class="normal">tripal_ws</highlight><highlight class="stringliteral">&apos;,<sp/>TRIPAL_ERROR,</highlight></codeline>
<codeline lineno="309"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">Tripal<sp/>remote<sp/>web<sp/>services<sp/>reports<sp/>the<sp/>following<sp/>error:<sp/>!error.</highlight><highlight class="stringliteral">&apos;,</highlight></codeline>
<codeline lineno="310"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>array(&apos;</highlight><highlight class="normal">!error</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$error));</highlight></codeline>
<codeline lineno="311"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="312"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="329" refid="d0/d59/group__tripal__ws__api_1ga7e5d7b4d8e3e2b41352639f2953e64c5" refkind="member"><highlight class="stringliteral">function<sp/>tripal_get_remote_context($context_url,<sp/>$cache_id)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="331"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$context_url)<sp/>{</highlight></codeline>
<codeline lineno="332"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">PLease<sp/>provide<sp/>a<sp/>context_url<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1ga7e5d7b4d8e3e2b41352639f2953e64c5" kindref="member">tripal_get_remote_context</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="333"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="334"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$cache_id)<sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">PLease<sp/>provide<sp/>unique<sp/>$cache_id<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1ga7e5d7b4d8e3e2b41352639f2953e64c5" kindref="member">tripal_get_remote_context</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="336"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="337"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="338"><highlight class="stringliteral"><sp/><sp/>if<sp/>($cache<sp/>=<sp/>cache_get($cache_id))<sp/>{</highlight></codeline>
<codeline lineno="339"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>$cache-&gt;data;</highlight></codeline>
<codeline lineno="340"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="342"><highlight class="stringliteral"><sp/><sp/>$context<sp/>=<sp/>drupal_http_request($context_url);</highlight></codeline>
<codeline lineno="343"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$context)<sp/>{</highlight></codeline>
<codeline lineno="344"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>tripal_report_error(&apos;</highlight><highlight class="normal">tripal_ws</highlight><highlight class="stringliteral">&apos;,<sp/>TRIPAL_ERROR,</highlight></codeline>
<codeline lineno="345"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">There<sp/>was<sp/>a<sp/>poblem<sp/>retrieving<sp/>the<sp/>context<sp/>from<sp/>the<sp/>remote<sp/>site:<sp/>!context_url.</highlight><highlight class="stringliteral">&apos;,</highlight></codeline>
<codeline lineno="346"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array(&apos;</highlight><highlight class="normal">!context_url</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$context_url));</highlight></codeline>
<codeline lineno="347"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline lineno="348"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="349"><highlight class="stringliteral"><sp/><sp/>$context<sp/>=<sp/>drupal_json_decode($context-&gt;data);</highlight></codeline>
<codeline lineno="350"><highlight class="stringliteral"><sp/><sp/>$context<sp/>=<sp/>$context[&apos;</highlight><highlight class="normal">@context</highlight><highlight class="stringliteral">&apos;];</highlight></codeline>
<codeline lineno="351"><highlight class="stringliteral"><sp/><sp/>cache_set($cache_id,<sp/>$context);</highlight></codeline>
<codeline lineno="352"><highlight class="stringliteral"><sp/><sp/>return<sp/>$context;</highlight></codeline>
<codeline lineno="353"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="354"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="380" refid="d0/d59/group__tripal__ws__api_1gafa217795f272e54f81654828a0506234" refkind="member"><highlight class="stringliteral">function<sp/>tripal_get_remote_content_context($site_id,<sp/>$context_url,<sp/>$bundle_accession,<sp/>$field_accession<sp/>=<sp/>&apos;</highlight><highlight class="stringliteral">&apos;)<sp/>{</highlight></codeline>
<codeline lineno="381"><highlight class="stringliteral"><sp/><sp/>$cache_id<sp/>=<sp/>substr(&apos;</highlight><highlight class="normal">trp_ws_context_</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$site_id<sp/>.<sp/>&apos;</highlight><highlight class="normal">-</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$bundle_accession<sp/>.<sp/>&apos;</highlight><highlight class="normal">-</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$field_accession,<sp/>0,<sp/>254);</highlight></codeline>
<codeline lineno="382"><highlight class="stringliteral"><sp/><sp/>$context<sp/>=<sp/>tripal_get_remote_context($context_url,<sp/>$cache_id);</highlight></codeline>
<codeline lineno="383"><highlight class="stringliteral"><sp/><sp/>return<sp/>$context;</highlight></codeline>
<codeline lineno="384"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="385"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="398" refid="d0/d59/group__tripal__ws__api_1ga423162ba2093c4eaa263480c56d1b07a" refkind="member"><highlight class="stringliteral">function<sp/>tripal_clear_remote_cache($site_id)<sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$site_id)<sp/>{</highlight></codeline>
<codeline lineno="400"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>a<sp/>numeric<sp/>site<sp/>ID<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1ga423162ba2093c4eaa263480c56d1b07a" kindref="member">tripal_clear_remote_cache</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="401"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="402"><highlight class="stringliteral"><sp/><sp/>cache_clear_all(&apos;</highlight><highlight class="normal">trp_ws_context_</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$site_id<sp/>,<sp/>&apos;</highlight><highlight class="normal">cache</highlight><highlight class="stringliteral">&apos;,<sp/>TRUE);</highlight></codeline>
<codeline lineno="403"><highlight class="stringliteral"><sp/><sp/>cache_clear_all(&apos;</highlight><highlight class="normal">trp_ws_doc_</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$site_id<sp/>,<sp/>&apos;</highlight><highlight class="normal">cache</highlight><highlight class="stringliteral">&apos;,<sp/>TRUE);</highlight></codeline>
<codeline lineno="404"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="416" refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" refkind="member"><highlight class="stringliteral">function<sp/>tripal_get_remote_API_doc($site_id)<sp/>{</highlight></codeline>
<codeline lineno="417"><highlight class="stringliteral"><sp/><sp/>$site_doc<sp/>=<sp/>&apos;</highlight><highlight class="stringliteral">&apos;;</highlight></codeline>
<codeline lineno="418"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="419"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$site_id)<sp/>{</highlight></codeline>
<codeline lineno="420"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>a<sp/>numeric<sp/>site<sp/>ID<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="421"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="423"><highlight class="stringliteral"><sp/><sp/>$cache_name<sp/>=<sp/>&apos;</highlight><highlight class="normal">trp_ws_doc_</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$site_id;</highlight></codeline>
<codeline lineno="424"><highlight class="stringliteral"><sp/><sp/>if<sp/>($cache<sp/>=<sp/>cache_get($cache_name))<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>$cache-&gt;data;</highlight></codeline>
<codeline lineno="426"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="428"><highlight class="stringliteral"><sp/><sp/>//<sp/>Get<sp/>the<sp/>site<sp/>url<sp/>from<sp/>the<sp/>tripal_sites<sp/>table.</highlight></codeline>
<codeline lineno="429"><highlight class="stringliteral"><sp/><sp/>$remote_site<sp/>=<sp/>db_select(&apos;</highlight><highlight class="normal">tripal_sites</highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal">ts</highlight><highlight class="stringliteral">&apos;)</highlight></codeline>
<codeline lineno="430"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;fields(&apos;</highlight><highlight class="normal">ts</highlight><highlight class="stringliteral">&apos;)</highlight></codeline>
<codeline lineno="431"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;condition(&apos;</highlight><highlight class="normal">ts.id</highlight><highlight class="stringliteral">&apos;,<sp/>$site_id)</highlight></codeline>
<codeline lineno="432"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;execute()</highlight></codeline>
<codeline lineno="433"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-&gt;fetchObject();</highlight></codeline>
<codeline lineno="434"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="435"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$remote_site)<sp/>{</highlight></codeline>
<codeline lineno="436"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(t(&apos;</highlight><highlight class="normal">Cannot<sp/>find<sp/>a<sp/>remote<sp/>site<sp/>with<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;!id&quot;</highlight><highlight class="stringliteral">&apos;,<sp/>array(&apos;</highlight><highlight class="normal">!</highlight><highlight class="keywordtype">id</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$site_id)));</highlight></codeline>
<codeline lineno="437"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="438"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="439"><highlight class="stringliteral"><sp/><sp/>//<sp/>Build<sp/>the<sp/>URL<sp/>to<sp/>the<sp/>remote<sp/>web<sp/>services.</highlight></codeline>
<codeline lineno="440"><highlight class="stringliteral"><sp/><sp/>$ws_version<sp/>=<sp/>$remote_site-&gt;version;</highlight></codeline>
<codeline lineno="441"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>=<sp/>$remote_site-&gt;url;</highlight></codeline>
<codeline lineno="442"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>=<sp/>trim($ws_url,<sp/>&apos;</highlight><highlight class="normal">/</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="443"><highlight class="stringliteral"><sp/><sp/>$ws_url<sp/>.=<sp/>&apos;</highlight><highlight class="normal">/web-services/doc/</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>$ws_version;</highlight></codeline>
<codeline lineno="444"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="445"><highlight class="stringliteral"><sp/><sp/>//<sp/>Build<sp/>and<sp/>make<sp/>the<sp/>request.</highlight></codeline>
<codeline lineno="446"><highlight class="stringliteral"><sp/><sp/>$options<sp/>=<sp/>[];</highlight></codeline>
<codeline lineno="447"><highlight class="stringliteral"><sp/><sp/>$data<sp/>=<sp/>drupal_http_request($ws_url,<sp/>$options);</highlight></codeline>
<codeline lineno="448"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="449"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$data)<sp/>{</highlight></codeline>
<codeline lineno="450"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>tripal_report_error(&apos;</highlight><highlight class="normal">tripal_ws</highlight><highlight class="stringliteral">&apos;,<sp/>TRIPAL_ERROR,</highlight></codeline>
<codeline lineno="451"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t(&apos;</highlight><highlight class="normal">Could<sp/>not<sp/>connect<sp/>to<sp/>the<sp/>remote<sp/>web<sp/>service.</highlight><highlight class="stringliteral">&apos;));</highlight></codeline>
<codeline lineno="452"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline lineno="453"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="454"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="455"><highlight class="stringliteral"><sp/><sp/>//<sp/>If<sp/>the<sp/>data<sp/>object<sp/>has<sp/>an<sp/>error<sp/>then<sp/>this<sp/>is<sp/>some<sp/>sort<sp/>of</highlight></codeline>
<codeline lineno="456"><highlight class="stringliteral"><sp/><sp/>//<sp/>connection<sp/>error<sp/>(not<sp/>a<sp/>Tripal<sp/>web<sp/>servcies<sp/>error).</highlight></codeline>
<codeline lineno="457"><highlight class="stringliteral"><sp/><sp/>if<sp/>(property_exists($data,<sp/>&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;))<sp/>{</highlight></codeline>
<codeline lineno="458"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>tripal_report_error(&apos;</highlight><highlight class="normal">tripal_ws</highlight><highlight class="stringliteral">&apos;,<sp/>TRIPAL_ERROR,</highlight></codeline>
<codeline lineno="459"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">Remote<sp/>web<sp/>services<sp/>document<sp/>reports<sp/>the<sp/>following<sp/>error:<sp/>!error.<sp/>Using<sp/>URL:<sp/>!url</highlight><highlight class="stringliteral">&apos;,</highlight></codeline>
<codeline lineno="460"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>array(&apos;</highlight><highlight class="normal">!error</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$error,<sp/>&apos;</highlight><highlight class="normal">!url</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$ws_url));</highlight></codeline>
<codeline lineno="461"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline lineno="462"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="463"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="464"><highlight class="stringliteral"><sp/><sp/>//<sp/>We<sp/>got<sp/>a<sp/>response,<sp/>so<sp/>convert<sp/>it<sp/>to<sp/>a<sp/>PHP<sp/>array.</highlight></codeline>
<codeline lineno="465"><highlight class="stringliteral"><sp/><sp/>$site_doc<sp/>=<sp/>drupal_json_decode($data-&gt;data);</highlight></codeline>
<codeline lineno="466"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="467"><highlight class="stringliteral"><sp/><sp/>//<sp/>Check<sp/>if<sp/>there<sp/>was<sp/>a<sp/>Tripal<sp/>Web<sp/>Services<sp/>error.</highlight></codeline>
<codeline lineno="468"><highlight class="stringliteral"><sp/><sp/>if<sp/>(array_key_exists(&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;,<sp/>$data))<sp/>{</highlight></codeline>
<codeline lineno="469"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>$error<sp/>=<sp/>&apos;</highlight><highlight class="normal">&lt;/pre&gt;</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>print_r($data[&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;],<sp/>TRUE)<sp/>.<sp/>&apos;</highlight><highlight class="normal">&lt;/pre&gt;</highlight><highlight class="stringliteral">&apos;;</highlight></codeline>
<codeline lineno="470"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>tripal_report_error(&apos;</highlight><highlight class="normal">tripal_ws</highlight><highlight class="stringliteral">&apos;,<sp/>TRIPAL_ERROR,</highlight></codeline>
<codeline lineno="471"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">Tripal<sp/>Remote<sp/>web<sp/>services<sp/>document<sp/>reports<sp/>the<sp/>following<sp/>error:<sp/>!error.<sp/>Using<sp/>URL:<sp/>!url</highlight><highlight class="stringliteral">&apos;,</highlight></codeline>
<codeline lineno="472"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>array(&apos;</highlight><highlight class="normal">!error</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$error,<sp/>&apos;</highlight><highlight class="normal">!url</highlight><highlight class="stringliteral">&apos;<sp/>=&gt;<sp/>$ws_url));</highlight></codeline>
<codeline lineno="473"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline lineno="474"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="475"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="476"><highlight class="stringliteral"><sp/><sp/>cache_set($cache_name,<sp/>$site_doc);</highlight></codeline>
<codeline lineno="477"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="478"><highlight class="stringliteral"><sp/><sp/>return<sp/>$site_doc;</highlight></codeline>
<codeline lineno="479"><highlight class="stringliteral">}</highlight></codeline>
<codeline lineno="480"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="504" refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" refkind="member"><highlight class="stringliteral">function<sp/>tripal_load_remote_entities($remote_entity_ids,<sp/>$site_id,<sp/>$bundle_accession,<sp/>$field_ids)<sp/>{</highlight></codeline>
<codeline lineno="505"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="506"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$remote_entity_ids)<sp/>{</highlight></codeline>
<codeline lineno="507"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>the<sp/>list<sp/>of<sp/>remote<sp/>entity<sp/>ids<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" kindref="member">tripal_load_remote_entities</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="508"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="509"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!is_array($remote_entity_ids))<sp/>{</highlight></codeline>
<codeline lineno="510"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>an<sp/>array<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/>remote<sp/>entity<sp/>ids<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" kindref="member">tripal_load_remote_entities</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="511"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="512"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$site_id)<sp/>{</highlight></codeline>
<codeline lineno="513"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>a<sp/>numeric<sp/>site<sp/>ID<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" kindref="member">tripal_load_remote_entities</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="514"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="515"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$bundle_accession)<sp/>{</highlight></codeline>
<codeline lineno="516"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>the<sp/>bundle<sp/>accession<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" kindref="member">tripal_load_remote_entities</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="517"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="518"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!$field_ids)<sp/>{</highlight></codeline>
<codeline lineno="519"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>the<sp/>list<sp/>of<sp/>field<sp/>IDs<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" kindref="member">tripal_load_remote_entities</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="520"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="521"><highlight class="stringliteral"><sp/><sp/>if<sp/>(!is_array($field_ids))<sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>Exception(&apos;</highlight><highlight class="normal">Please<sp/>provide<sp/>an<sp/>array<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/>field<sp/>IDs<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>the<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa8ee3243cd4e5ff9951fe21c456836d7" kindref="member">tripal_load_remote_entities</ref><sp/></highlight><highlight class="keyword">function</highlight><highlight class="normal">.</highlight><highlight class="stringliteral">&apos;);</highlight></codeline>
<codeline lineno="523"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="524"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="525"><highlight class="stringliteral"><sp/><sp/>//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight></codeline>
<codeline lineno="526"><highlight class="stringliteral"><sp/><sp/>$site_doc<sp/>=<sp/>tripal_get_remote_API_doc($site_id);</highlight></codeline>
<codeline lineno="527"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="528"><highlight class="stringliteral"><sp/><sp/>//<sp/>Generate<sp/>an<sp/>array<sp/>for<sp/>the<sp/>query<sp/>and<sp/>then<sp/>execute<sp/>it.</highlight></codeline>
<codeline lineno="529"><highlight class="stringliteral"><sp/><sp/>$query<sp/>=<sp/>&apos;</highlight><highlight class="normal">page=1&amp;limit=</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>count($remote_entity_ids)<sp/>.</highlight></codeline>
<codeline lineno="530"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">&amp;ids=</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>urlencode(implode(&quot;,&quot;,<sp/>$remote_entity_ids))<sp/>.</highlight></codeline>
<codeline lineno="531"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;</highlight><highlight class="normal">&amp;fields=</highlight><highlight class="stringliteral">&apos;<sp/>.<sp/>urlencode(implode(&quot;,&quot;,<sp/>$field_ids));</highlight></codeline>
<codeline lineno="532"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="533"><highlight class="stringliteral"><sp/><sp/>$results<sp/>=<sp/>tripal_get_remote_content($site_id,<sp/>$bundle_accession,<sp/>$query);</highlight></codeline>
<codeline lineno="534"><highlight class="stringliteral"><sp/><sp/></highlight></codeline>
<codeline lineno="535"><highlight class="stringliteral"><sp/><sp/>//<sp/>If<sp/>we<sp/>encountered<sp/>an<sp/>error<sp/>just<sp/>return;</highlight></codeline>
<codeline lineno="536"><highlight class="stringliteral"><sp/><sp/>if<sp/>(array_key_exists(&apos;</highlight><highlight class="normal">error</highlight><highlight class="stringliteral">&apos;,<sp/>$results))<sp/>{</highlight></codeline>
<codeline lineno="537"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline lineno="538"><highlight class="stringliteral"><sp/><sp/>}</highlight></codeline>
<codeline lineno="539"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="540"><highlight class="stringliteral"><sp/><sp/>//<sp/>Get<sp/>the<sp/>context<sp/>JSON<sp/>for<sp/>this<sp/>remote<sp/>entity,<sp/>we&apos;</highlight><highlight class="normal">ll<sp/>use<sp/>it<sp/>to<sp/>map</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/>$context_url<sp/>=<sp/><ref refid="dd/d72/tripal__library__features_8tpl_8php_1a233d12bd8b6d3453e9a7a3f0b8c31db2" kindref="member">$results</ref>[</highlight><highlight class="stringliteral">&apos;@context&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/>$context<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gafa217795f272e54f81654828a0506234" kindref="member">tripal_get_remote_content_context</ref>($site_id,<sp/>$context_url,<sp/>$bundle_accession);</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!$context)<sp/>{</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$entity;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/>$total_items<sp/>=<sp/><ref refid="dd/d72/tripal__library__features_8tpl_8php_1a233d12bd8b6d3453e9a7a3f0b8c31db2" kindref="member">$results</ref>[</highlight><highlight class="stringliteral">&apos;totalItems&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/>$members<sp/>=<sp/><ref refid="dd/d72/tripal__library__features_8tpl_8php_1a233d12bd8b6d3453e9a7a3f0b8c31db2" kindref="member">$results</ref>[</highlight><highlight class="stringliteral">&apos;member&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/>$entities<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($members<sp/>as<sp/>$member)<sp/>{</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>building<sp/>the<sp/>fake<sp/>entity.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity_id<sp/>=<sp/>preg_replace(</highlight><highlight class="stringliteral">&apos;/^.*?(\d+)$/&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;$1&apos;</highlight><highlight class="normal">,<sp/>$member[</highlight><highlight class="stringliteral">&apos;@id&apos;</highlight><highlight class="normal">]);</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>stdClass();</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;entityType<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;TripalEntity&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;entityInfo<sp/>=<sp/>[];</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;id<sp/>=<sp/>$entity_id;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;TripalEntity&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;bundle<sp/>=<sp/>$bundle_accession;</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;site_id<sp/>=<sp/>$site_id;</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/>$member<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" kindref="member">_tripal_update_remote_entity_field</ref>($member,<sp/>$context,<sp/>1);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($member<sp/>as<sp/>$field_id<sp/>=&gt;<sp/>$value)<sp/>{</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$field<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaf420ee503552d259852ba61f1123ea83" kindref="member">tripal_get_remote_field_info</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_id);</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$instance<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1ga882c3206ab764a16d99b034b35050323" kindref="member">tripal_get_remote_field_instance_info</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_id);</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$field_name<sp/>=<sp/>$field[</highlight><highlight class="stringliteral">&apos;field_name&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$entity-&gt;{$field_name}[</highlight><highlight class="stringliteral">&apos;und&apos;</highlight><highlight class="normal">][0][</highlight><highlight class="stringliteral">&apos;value&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$value;</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/>$entities[$entity_id]<sp/>=<sp/>$entity;</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$entities;</highlight></codeline>
<codeline lineno="573"><highlight class="normal">}</highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight></codeline>
<codeline lineno="597" refid="d0/d59/group__tripal__ws__api_1gaa7baa2401471aab9ee0181e9f093b13a" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa7baa2401471aab9ee0181e9f093b13a" kindref="member">tripal_load_remote_entity</ref>($remote_entity_id,<sp/>$site_id,<sp/>$bundle_accession,<sp/>$field_ids)<sp/>{</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/>$site_doc<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref>($site_id);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>remote<sp/>entity<sp/>and<sp/>create<sp/>the<sp/>fake<sp/>entity.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/>$remote_entity<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa2730a7f144bf318af7d3c9893a57f54" kindref="member">tripal_get_remote_content</ref>($site_id,<sp/>$bundle_accession<sp/>.<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal"><sp/>.<sp/>$remote_entity_id);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>we<sp/>encountered<sp/>an<sp/>error<sp/>just<sp/>return;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(array_key_exists(</highlight><highlight class="stringliteral">&apos;error&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/d72/tripal__library__features_8tpl_8php_1a233d12bd8b6d3453e9a7a3f0b8c31db2" kindref="member">$results</ref>))<sp/>{</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FALSE;</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>building<sp/>the<sp/>fake<sp/>entity.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/>$entity<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>stdClass();</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/>$entity-&gt;entityType<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;TripalEntity&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/>$entity-&gt;entityInfo<sp/>=<sp/>[];</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/>$entity-&gt;id<sp/>=<sp/>$remote_entity_id;</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/>$entity-&gt;type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;TripalEntity&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/>$entity-&gt;bundle<sp/>=<sp/>$bundle_accession;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/>$entity-&gt;site_id<sp/>=<sp/>$site_id;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>context<sp/>JSON<sp/>for<sp/>this<sp/>remote<sp/>entity,<sp/>we&apos;ll<sp/>use<sp/>it<sp/>to<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/>$context_url<sp/>=<sp/>$remote_entity[</highlight><highlight class="stringliteral">&apos;@context&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/>$context<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gafa217795f272e54f81654828a0506234" kindref="member">tripal_get_remote_content_context</ref>($site_id,<sp/>$context_url,<sp/>$bundle_accession);</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!$context)<sp/>{</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$entity;</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>through<sp/>the<sp/>fields<sp/>and<sp/>the<sp/>those<sp/>values<sp/>to<sp/>the<sp/>entity.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($field_ids<sp/>as<sp/>$field_id)<sp/>{</highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/>$field<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaf420ee503552d259852ba61f1123ea83" kindref="member">tripal_get_remote_field_info</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_id);</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/>$instance<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1ga882c3206ab764a16d99b034b35050323" kindref="member">tripal_get_remote_field_instance_info</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_id);</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/>$field_name<sp/>=<sp/>$field[</highlight><highlight class="stringliteral">&apos;field_name&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/>$field_key<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($context<sp/>as<sp/>$k<sp/>=&gt;<sp/>$v)<sp/>{</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_array($v)<sp/>and<sp/>$v<sp/>==<sp/>$field_id)<sp/>{</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$field_key<sp/>=<sp/>$k;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="639"><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>field<sp/>is<sp/>not<sp/>in<sp/>this<sp/>remote<sp/>bundle<sp/>then<sp/>add<sp/>an<sp/>empty<sp/>value.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!$field_key)<sp/>{</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$entity-&gt;{$field_name}[</highlight><highlight class="stringliteral">&apos;und&apos;</highlight><highlight class="normal">][0][</highlight><highlight class="stringliteral">&apos;value&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!array_key_exists($field_key,<sp/>$remote_entity))<sp/>{</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$entity-&gt;{$field_name}[</highlight><highlight class="stringliteral">&apos;und&apos;</highlight><highlight class="normal">][0][</highlight><highlight class="stringliteral">&apos;value&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>key<sp/>is<sp/>for<sp/>a<sp/>field<sp/>that<sp/>is<sp/>not<sp/>&quot;auto<sp/>attached&apos;<sp/>then<sp/>we<sp/>need</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>to<sp/>get<sp/>that<sp/>field<sp/>through<sp/>a<sp/>separate<sp/>call.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/>$attached<sp/>=<sp/>TRUE;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(array_key_exists($field_id,<sp/>$context)<sp/>and<sp/>is_array($context[$field_id])<sp/>and</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array_key_exists(</highlight><highlight class="stringliteral">&apos;@type&apos;</highlight><highlight class="normal">,<sp/>$context[$field_id])<sp/>and<sp/>$context[$field_id][</highlight><highlight class="stringliteral">&apos;@type&apos;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;@id&apos;</highlight><highlight class="normal">){</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$attached<sp/>=<sp/>FALSE;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>value<sp/>for<sp/>this<sp/>field.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/>$value<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_array($remote_entity[$field_key]))<sp/>{</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$value<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" kindref="member">_tripal_update_remote_entity_field</ref>($remote_entity[$field_key],<sp/>$context,<sp/>1);</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$value<sp/>=<sp/>$remote_entity[$field_key];</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>field<sp/>is<sp/>not<sp/>attached<sp/>then<sp/>we<sp/>have<sp/>to<sp/>query<sp/>another<sp/>level.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!$attached)<sp/>{</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$field_data<sp/>=<sp/>drupal_http_request($value);</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!$field_data)<sp/>{</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d9/dae/group__tripal__notify__api_1ga2240e326e18c3074843ac815e4629ee2" kindref="member">tripal_report_error</ref>(</highlight><highlight class="stringliteral">&apos;tripal_ws&apos;</highlight><highlight class="normal">,<sp/><ref refid="dd/d45/tripal_8notice_8api_8inc_1a4b04c4b1ce52da710d57abf5c4b09dd3" kindref="member">TRIPAL_ERROR</ref>,</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;There<sp/>was<sp/>a<sp/>poblem<sp/>retrieving<sp/>the<sp/>unattached<sp/>field,<sp/>&quot;!field:&quot;,<sp/>for<sp/>the<sp/>remote<sp/>entity:<sp/>!entity_id.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array(</highlight><highlight class="stringliteral">&apos;!field&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$field_id,<sp/></highlight><highlight class="stringliteral">&apos;!entity_id&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$remote_entity_id));</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$value<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$field_data<sp/>=<sp/>drupal_json_decode($field_data-&gt;data);</highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>context<sp/>for<sp/>this<sp/>field<sp/>so<sp/>we<sp/>can<sp/>map<sp/>the<sp/>keys<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>controlled<sp/>vocabulary<sp/>accessions.<sp/>If<sp/>it<sp/>fails<sp/>then<sp/>skip<sp/>this<sp/>field.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$field_context_url<sp/>=<sp/>$field_data[</highlight><highlight class="stringliteral">&apos;@context&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$field_context<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gafa217795f272e54f81654828a0506234" kindref="member">tripal_get_remote_content_context</ref>($site_id,<sp/>$field_context_url,<sp/>$bundle_accession,<sp/>$field_id);</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!$field_context)<sp/>{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$value<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" kindref="member">_tripal_update_remote_entity_field</ref>($field_data,<sp/>$field_context);</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/>$entity-&gt;{$field_name}[</highlight><highlight class="stringliteral">&apos;und&apos;</highlight><highlight class="normal">][0][</highlight><highlight class="stringliteral">&apos;value&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$value;</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$entity;</highlight></codeline>
<codeline lineno="691"><highlight class="normal">}</highlight></codeline>
<codeline lineno="692"><highlight class="normal"></highlight></codeline>
<codeline lineno="706" refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" kindref="member">_tripal_update_remote_entity_field</ref>($field_data,<sp/>$context,<sp/>$depth<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>this<sp/>is<sp/>an<sp/>array.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($field_data[</highlight><highlight class="stringliteral">&apos;@type&apos;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;Collection&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$members<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($field_data[</highlight><highlight class="stringliteral">&apos;member&apos;</highlight><highlight class="normal">]<sp/>as<sp/>$member)<sp/>{</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$next_depth<sp/>=<sp/>$depth<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$members[]<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" kindref="member">_tripal_update_remote_entity_field</ref>($member,<sp/>$context,<sp/>$next_depth);</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>we<sp/>only<sp/>have<sp/>one<sp/>item<sp/>then<sp/>just<sp/>return<sp/>it<sp/>as<sp/>a<sp/>single<sp/>item.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>we<sp/>may<sp/>need<sp/>to<sp/>check<sp/>cardinality<sp/>of<sp/>the<sp/>field<sp/>and<sp/>be<sp/>more</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>strict<sp/>about<sp/>how<sp/>we<sp/>return<sp/>the<sp/>value.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($field_data[</highlight><highlight class="stringliteral">&apos;totalItems&apos;</highlight><highlight class="normal">]<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$members[0];</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$members;</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/>$value<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>($field_data<sp/>as<sp/>$k<sp/>=&gt;<sp/>$v)<sp/>{</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Skip<sp/>the<sp/>JSON-LD<sp/>keys.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($k<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;@id&apos;</highlight><highlight class="normal"><sp/>or<sp/>$k<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;@type&apos;</highlight><highlight class="normal"><sp/>or<sp/>$k<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;@context&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>the<sp/>term<sp/>accession<sp/>for<sp/>this<sp/>element,<sp/>and<sp/>if<sp/>the<sp/>key&apos;s<sp/>value<sp/>is<sp/>an</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>array<sp/>then<sp/>recurse.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$accession<sp/>=<sp/>$context[$k];</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_array($v))<sp/>{</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$next_depth<sp/>=<sp/>$depth<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$subvalue<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaabfe1c20d0c4dd02be61e0c3339b0bac" kindref="member">_tripal_update_remote_entity_field</ref>($v,<sp/>$context,<sp/>$next_depth);</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$value[$accession]<sp/>=<sp/>$subvalue;</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$value[$accession]<sp/>=<sp/>$v;</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$value;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal">}</highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight></codeline>
<codeline lineno="770" refid="d0/d59/group__tripal__ws__api_1gaf420ee503552d259852ba61f1123ea83" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1gaf420ee503552d259852ba61f1123ea83" kindref="member">tripal_get_remote_field_info</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession){</highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/>$site_doc<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref>($site_id);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>property<sp/>from<sp/>the<sp/>document<sp/>for<sp/>this<sp/>field.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref><sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gacce8c27bef223dc195354a329e39d640" kindref="member">tripal_get_remote_field_doc</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession);</highlight></codeline>
<codeline lineno="777"><highlight class="normal"></highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Now<sp/>create<sp/>the<sp/>fake<sp/>field<sp/>and<sp/>instance.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/>list($vocab,<sp/>$accession)<sp/>=<sp/>explode(</highlight><highlight class="charliteral">&apos;:&apos;</highlight><highlight class="normal">,<sp/>$field_accession);</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/>$field_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;tripal_remote_site_&apos;</highlight><highlight class="normal"><sp/>.<sp/>$site_id<sp/>.<sp/></highlight><highlight class="charliteral">&apos;_&apos;</highlight><highlight class="normal"><sp/>.<sp/>$field_accession;</highlight></codeline>
<codeline lineno="781"><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/>$field<sp/>=<sp/>array(</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;field_name&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$field_name,</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$field_name,</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;storage&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/></highlight><highlight class="stringliteral">&apos;tripal_remote_site&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$field;</highlight></codeline>
<codeline lineno="790"><highlight class="normal">}</highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight></codeline>
<codeline lineno="812" refid="d0/d59/group__tripal__ws__api_1ga882c3206ab764a16d99b034b35050323" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1ga882c3206ab764a16d99b034b35050323" kindref="member">tripal_get_remote_field_instance_info</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession){</highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/>$site_doc<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref>($site_id);</highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>property<sp/>from<sp/>the<sp/>document<sp/>for<sp/>this<sp/>field.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref><sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gacce8c27bef223dc195354a329e39d640" kindref="member">tripal_get_remote_field_doc</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession);</highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/>list($vocab,<sp/>$accession)<sp/>=<sp/>explode(</highlight><highlight class="charliteral">&apos;:&apos;</highlight><highlight class="normal">,<sp/>$field_accession);</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/>$field_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;tripal_remote_site_&apos;</highlight><highlight class="normal"><sp/>.<sp/>$site_id<sp/>.<sp/></highlight><highlight class="charliteral">&apos;_&apos;</highlight><highlight class="normal"><sp/>.<sp/>$field_accession;</highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/>list($vocab,<sp/>$accession)<sp/>=<sp/>explode(</highlight><highlight class="charliteral">&apos;:&apos;</highlight><highlight class="normal">,<sp/>$field_accession);</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/>$instance<sp/>=<sp/>array(</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;label&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref>[</highlight><highlight class="stringliteral">&apos;hydra:title&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;description&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref>[</highlight><highlight class="stringliteral">&apos;hydra:description&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;formatters&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref>[</highlight><highlight class="stringliteral">&apos;tripal_formatters&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;settings&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;term_vocabulary&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$vocab,</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;term_accession&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$accession</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;field_name&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$field_name,</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;entity_type&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/></highlight><highlight class="stringliteral">&apos;TripalEntity&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;bundle_name&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$bundle_accession,</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$instance;</highlight></codeline>
<codeline lineno="837"><highlight class="normal">}</highlight></codeline>
<codeline lineno="838"><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight></codeline>
<codeline lineno="857" refid="d0/d59/group__tripal__ws__api_1ga71b6139da4c605252b6c539215d072f9" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1ga71b6139da4c605252b6c539215d072f9" kindref="member">tripal_get_remote_content_doc</ref>($site_id,<sp/>$bundle_accession){</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/>$site_doc<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref>($site_id);</highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>class<sp/>that<sp/>matches<sp/>this<sp/>bundle.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><ref refid="db/d43/tripal__data_8tpl_8php_1a6d48ecbdbc70ca1812e665169b5fa1e2" kindref="member">$classes</ref><sp/>=<sp/>$site_doc[</highlight><highlight class="stringliteral">&apos;supportedClass&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/>$class<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>(<ref refid="db/d43/tripal__data_8tpl_8php_1a6d48ecbdbc70ca1812e665169b5fa1e2" kindref="member">$classes</ref><sp/>as<sp/>$item)<sp/>{</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($item[</highlight><highlight class="stringliteral">&apos;@id&apos;</highlight><highlight class="normal">]<sp/>==<sp/>$bundle_accession)<sp/>{</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$item;</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="871"><highlight class="normal">}</highlight></codeline>
<codeline lineno="872"><highlight class="normal"></highlight></codeline>
<codeline lineno="894" refid="d0/d59/group__tripal__ws__api_1gacce8c27bef223dc195354a329e39d640" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1gacce8c27bef223dc195354a329e39d640" kindref="member">tripal_get_remote_field_doc</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession){</highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/>$site_doc<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref>($site_id);</highlight></codeline>
<codeline lineno="898"><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/>$class<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1ga71b6139da4c605252b6c539215d072f9" kindref="member">tripal_get_remote_content_doc</ref>($site_id,<sp/>$bundle_accession);</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><ref refid="d5/d66/tripal__organism__properties_8tpl_8php_1a7f675de4b5983d7e84f6573b7d4d453d" kindref="member">$properties</ref><sp/>=<sp/>$class[</highlight><highlight class="stringliteral">&apos;supportedProperty&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>(<ref refid="d5/d66/tripal__organism__properties_8tpl_8php_1a7f675de4b5983d7e84f6573b7d4d453d" kindref="member">$properties</ref><sp/>as<sp/>$item)<sp/>{</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($item[</highlight><highlight class="stringliteral">&apos;property&apos;</highlight><highlight class="normal">]<sp/>==<sp/>$field_accession)<sp/>{</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$item;</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="907"><highlight class="normal">}</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"></highlight></codeline>
<codeline lineno="932" refid="d0/d59/group__tripal__ws__api_1gaa4a572e98c30c3596c6dec4afd6a4811" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="d0/d59/group__tripal__ws__api_1gaa4a572e98c30c3596c6dec4afd6a4811" kindref="member">tripal_get_remote_field_formatters</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession)<sp/>{</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/>$flist<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="935"><highlight class="normal"></highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>site<sp/>documentation<sp/>(loads<sp/>from<sp/>cache<sp/>if<sp/>already<sp/>retrieved).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/>$site_doc<sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gaeb4f0c0437b910b3265718424967ab62" kindref="member">tripal_get_remote_API_doc</ref>($site_id);</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref><sp/>=<sp/><ref refid="d0/d59/group__tripal__ws__api_1gacce8c27bef223dc195354a329e39d640" kindref="member">tripal_get_remote_field_doc</ref>($site_id,<sp/>$bundle_accession,<sp/>$field_accession);</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref>)<sp/>{</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$flist;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="942"><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/>$formatters<sp/>=<sp/><ref refid="de/d47/tripal__project__base_8tpl_8php_1aca07184a1d9c6d3817265d594c356071" kindref="member">$property</ref>[</highlight><highlight class="stringliteral">&apos;tripal_formatters&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($formatters<sp/>as<sp/>$formatter)<sp/>{</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="df/d0f/group__tripal__fields__api_1ga6228dd432f683e12dd97639bbc848314" kindref="member">tripal_load_include_downloader_class</ref>($formatter))<sp/>{</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$flist[$formatter]<sp/>=<sp/>$formatter::$full_label;</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$flist;</highlight></codeline>
<codeline lineno="950"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="tripal_ws/api/tripal_ws.api.inc"/>
  </compounddef>
</doxygen>

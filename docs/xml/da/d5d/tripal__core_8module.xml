<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.15">
  <compounddef id="da/d5d/tripal__core_8module" kind="file" language="C++">
    <compoundname>tripal_core.module</compoundname>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline><highlight class="normal">&lt;?php</highlight></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@file</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>The<sp/>Tripal<sp/>Core<sp/>module</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@defgroup<sp/>tripal_legacy_api<sp/>Tripal<sp/>Legacy<sp/>API</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@{</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Provides<sp/>an<sp/>application<sp/>programming<sp/>interface<sp/>(API)<sp/>for<sp/>Tripal<sp/>v2</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>backwards-compatibilty.<sp/>These<sp/>functions<sp/>are<sp/>DEPRECATED<sp/>and<sp/>may<sp/>not</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>be<sp/>available<sp/>in<sp/>future<sp/>version<sp/>of<sp/>Tripal.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@}</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@defgroup<sp/>tripal_legacy_core<sp/>Legacy<sp/>Tripal<sp/>Core<sp/>Module</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_modules</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@{</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Functionality<sp/>useful<sp/>for<sp/>all<sp/>other<sp/>Tripal<sp/>modules<sp/>including<sp/>the<sp/>Tripal<sp/>jobs,<sp/>files,</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>materialized<sp/>views<sp/>and<sp/>custom<sp/>table<sp/>functions.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@}</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;api/tripal_core.chado_nodes.api.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;api/tripal_core.chado_nodes.title_and_path.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;api/tripal_core.chado_nodes.properties.api.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;api/tripal_core.chado_nodes.dbxrefs.api.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;api/tripal_core.chado_nodes.relationships.api.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;api/tripal_core.tripal_variables.api.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;includes/tripal_core.form_elements.inc&apos;;</highlight></codeline>
<codeline><highlight class="normal">require_once<sp/>&apos;includes/tripal_core.search.inc&apos;;</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_init().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Used<sp/>to<sp/>set<sp/>the<sp/>search_path,<sp/>create<sp/>default<sp/>content<sp/>and<sp/>set<sp/>default<sp/>variables.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_init()<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>If<sp/>we<sp/>want<sp/>AHAH<sp/>elements<sp/>on<sp/>the<sp/>node<sp/>forms<sp/>(e.g.<sp/>chado_pub<sp/>form)<sp/>then<sp/>we<sp/>need<sp/>to<sp/>include</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>the<sp/>node.pages<sp/>file.<sp/>Otherwise<sp/>this<sp/>error<sp/>message<sp/>is<sp/>given:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>warning:<sp/>call_user_func_array()<sp/>expects<sp/>parameter<sp/>1<sp/>to<sp/>be<sp/>a<sp/>valid<sp/>callback,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>function<sp/>&apos;node_form&apos;<sp/>not<sp/>found<sp/>or<sp/>invalid<sp/>function<sp/>name</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>in<sp/>/var/www/includes/form.inc<sp/>on<sp/>line<sp/>382.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>module_load_include(&apos;inc&apos;,<sp/>&apos;node&apos;,<sp/>&apos;node.pages&apos;);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_menu().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Defines<sp/>all<sp/>menu<sp/>items<sp/>needed<sp/>by<sp/>Tripal<sp/>Core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_menu()<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$items<sp/>=<sp/>array();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Triapl<sp/>setting<sp/>groups</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$items[&apos;admin/tripal/legacy&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;title&apos;<sp/>=&gt;<sp/>&apos;Tripal<sp/>Legacy&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;description&apos;<sp/>=&gt;<sp/>t(&quot;Legacy<sp/>functionality<sp/>from<sp/>Tripal<sp/>v2.0.&quot;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;weight&apos;<sp/>=&gt;<sp/>-8,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;page<sp/>callback&apos;<sp/>=&gt;<sp/>&apos;system_admin_menu_block_page&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;access<sp/>arguments&apos;<sp/>=&gt;<sp/>array(&apos;administer<sp/>tripal&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;file&apos;<sp/>=&gt;<sp/>&apos;system.admin.inc&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;file<sp/>path&apos;<sp/>=&gt;<sp/>drupal_get_path(&apos;module&apos;,<sp/>&apos;system&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Relationshi<sp/>API<sp/>autocomplete<sp/>callback</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$items[&apos;tripal_ajax/relationship_nodeform/%/%/name_to_id&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;page<sp/>callback&apos;<sp/>=&gt;<sp/>&apos;chado_add_node_form_relationships_name_to_id_callback&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;page<sp/>arguments&apos;<sp/>=&gt;<sp/>array(2,3),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;access<sp/>arguments&apos;<sp/>=&gt;<sp/>array(&apos;access<sp/>content&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;type&apos;<sp/>=&gt;<sp/>MENU_CALLBACK</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>The<sp/>node&apos;s<sp/>TOC<sp/>tab</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$items[&apos;node/%node/tripal_toc&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;title&apos;<sp/>=&gt;<sp/>&apos;TOC&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;page<sp/>callback&apos;<sp/>=&gt;<sp/>&apos;drupal_get_form&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;page<sp/>arguments&apos;<sp/>=&gt;<sp/>array(&apos;tripal_core_node_toc_form&apos;,<sp/>1),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;access<sp/>callback&apos;<sp/>=&gt;<sp/>&apos;tripal_core_access_node_toc_form&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;access<sp/>arguments&apos;<sp/>=&gt;<sp/>array(1),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;type&apos;<sp/>=&gt;<sp/>MENU_LOCAL_TASK,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;file&apos;<sp/>=&gt;<sp/>&apos;/includes/tripal_core.toc.inc&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>$items;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>An<sp/>access<sp/>wrapper<sp/>function<sp/>for<sp/>editing<sp/>the<sp/>TOC</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@param<sp/>$node</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/><sp/><sp/>A<sp/>node<sp/>object</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@return</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/><sp/><sp/>Returns<sp/>TRUE<sp/>if<sp/>the<sp/>node<sp/>is<sp/>a<sp/>Tripal-based<sp/>node<sp/>and<sp/>the<sp/>user<sp/>hass</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/><sp/><sp/>the<sp/>&apos;administer<sp/>tripal&apos;<sp/>role.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_access_node_toc_form($node)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$types<sp/>=<sp/>module_invoke_all(&apos;node_info&apos;);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(array_key_exists($node-&gt;type,<sp/>$types)<sp/>and</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>array_key_exists(&apos;chado_node_api&apos;,<sp/>$types[$node-&gt;type]))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>return<sp/>user_access(&apos;administer<sp/>tripal&apos;);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>FALSE;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_permission().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Set<sp/>the<sp/>permission<sp/>types<sp/>that<sp/>the<sp/>chado<sp/>module<sp/>uses.<sp/><sp/>Essentially<sp/>we</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/><sp/>want<sp/>permissionis<sp/>that<sp/>protect<sp/>creation,<sp/>editing<sp/>and<sp/>deleting<sp/>of<sp/>chado</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/><sp/>data<sp/>objects</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_permission()<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>array();</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_theme().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Registers<sp/>template<sp/>files/functions<sp/>used<sp/>by<sp/>this<sp/>module.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_theme($existing,<sp/>$type,<sp/>$theme,<sp/>$path)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;tripal_core_customize&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;arguments&apos;<sp/>=&gt;<sp/>array(&apos;job_id&apos;<sp/>=&gt;<sp/>NULL),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;template&apos;<sp/>=&gt;<sp/>&apos;tripal_core_customize&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;path&apos;<sp/>=&gt;<sp/>&quot;$path/theme/templates&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;theme_file_upload_combo&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;theme_sequence_combo&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;tripal_core_jobs_help&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;template&apos;<sp/>=&gt;<sp/>&apos;tripal_core_jobs_help&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;variables&apos;<sp/>=&gt;<sp/><sp/>array(NULL),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;path&apos;<sp/>=&gt;<sp/>&quot;$path/theme/templates&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;tripal_core_customtables_help&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;template&apos;<sp/>=&gt;<sp/>&apos;tripal_core_customtables_help&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;variables&apos;<sp/>=&gt;<sp/><sp/>array(NULL),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;path&apos;<sp/>=&gt;<sp/>&quot;$path/theme/templates&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Chado<sp/>Node<sp/>API<sp/>Themes</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>--------------------------------</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Properties<sp/>Node<sp/>Form</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;chado_node_properties_form_table&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;function&apos;<sp/>=&gt;<sp/>&apos;theme_chado_add_node_form_properties&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Additional<sp/>Dbxrefs<sp/>Nore<sp/>Form</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;chado_node_additional_dbxrefs_form_table&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;function&apos;<sp/>=&gt;<sp/>&apos;theme_chado_add_node_form_dbxrefs_table&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Relationships<sp/>Nore<sp/>Form</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;chado_node_relationships_form_table&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;function&apos;<sp/>=&gt;<sp/>&apos;theme_chado_add_node_form_relationships_table&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Form<sp/>and<sp/>form<sp/>element<sp/>themes.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>--------------------------------</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;tripal_node_toc_items_table&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Theme<sp/>function<sp/>for<sp/>the<sp/>extension<sp/>admin<sp/>page.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;tripal_core_extensions_form_tables&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;render<sp/>element&apos;<sp/>=&gt;<sp/>&apos;element&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;administer<sp/>controlled<sp/>vocabularies&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;title&apos;<sp/>=&gt;<sp/>t(&apos;Administer<sp/>controlled<sp/>vocabularies<sp/>(CVs).&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;description&apos;<sp/>=&gt;<sp/>t(&apos;Allow<sp/>a<sp/>user<sp/>to<sp/>add,<sp/>edit<sp/>and<sp/>delete<sp/>controlled<sp/>vocabularies<sp/>as<sp/>well<sp/>as<sp/>add<sp/>and<sp/>edit<sp/>terms.&apos;)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_coder_ignore().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Defines<sp/>the<sp/>path<sp/>to<sp/>the<sp/>file<sp/>(tripal_core.coder_ignores.txt)<sp/>where<sp/>ignore</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>rules<sp/>for<sp/>coder<sp/>are<sp/>stored.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_coder_ignore()<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;path&apos;<sp/>=&gt;<sp/>drupal_get_path(&apos;module&apos;,<sp/>&apos;tripal_core&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;line<sp/>prefix&apos;<sp/>=&gt;<sp/>drupal_get_path(&apos;module&apos;,<sp/>&apos;tripal_core&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_views_api().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Essentially<sp/>this<sp/>hook<sp/>tells<sp/>drupal<sp/>that<sp/>there<sp/>is<sp/>views<sp/>support<sp/>for</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>for<sp/>this<sp/>module<sp/>which<sp/>then<sp/>includes<sp/>tripal_db.views.inc<sp/>where<sp/>all<sp/>the</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>views<sp/>integration<sp/>code<sp/>is.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_views_api()<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;api&apos;<sp/>=&gt;<sp/>3.0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_node_view_alter().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_node_view_alter(&amp;$build)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>module_load_include(&apos;inc&apos;,<sp/>&apos;tripal_core&apos;,<sp/>&apos;includes/tripal_core.toc&apos;);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>tripal_core_node_view_build_toc($build);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_node_view().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@ingroup<sp/>tripal_legacy_core</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_node_view($node,<sp/>$view_mode,<sp/>$langcode)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>if<sp/>this<sp/>node<sp/>type<sp/>is<sp/>a<sp/>chado-based<sp/>node<sp/>(i.e.<sp/>Tripal<sp/>node)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>the<sp/>we<sp/>want<sp/>to<sp/>add<sp/>a<sp/>table<sp/>of<sp/>contents<sp/>to<sp/>it&apos;s<sp/>content<sp/>list</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>this<sp/>table<sp/>of<sp/>contents<sp/>will<sp/>be<sp/>an<sp/>empty</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(preg_match(&apos;/^chado_/&apos;,<sp/>$node-&gt;type))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>($view_mode<sp/>==<sp/>&apos;full&apos;)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(!isset($node-&gt;content[&apos;#tripal_generic_node_template&apos;]))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$node-&gt;content[&apos;#tripal_generic_node_template&apos;]<sp/>=<sp/>TRUE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Adds<sp/>support<sp/>for<sp/>tokens<sp/>in<sp/>the<sp/>field_resource_links<sp/>field.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>The<sp/>field_resource_links<sp/>field<sp/>is<sp/>a<sp/>special<sp/>field<sp/>that<sp/>can<sp/>be<sp/>manually</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>added<sp/>by<sp/>the<sp/>site<sp/>admin<sp/>for<sp/>providing<sp/>links<sp/>on<sp/>the<sp/>Tripal<sp/>TOC<sp/>sidebar.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Using<sp/>tokens<sp/>will<sp/>allow<sp/>for<sp/>creation<sp/>of<sp/>custom<sp/>links.<sp/>This<sp/>function</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>will<sp/>add<sp/>a<sp/>fieldset<sp/>contiaining<sp/>the<sp/>list<sp/>of<sp/>appropriate<sp/>tokens<sp/>for<sp/>the</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>content<sp/>type.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@param<sp/>unknown<sp/>$element</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@param<sp/>unknown<sp/>$form_state</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>@param<sp/>unknown<sp/>$context</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_field_widget_form_alter(&amp;$element,<sp/>&amp;$form_state,<sp/>$context)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>If<sp/>the<sp/>name<sp/>of<sp/>the<sp/>field<sp/>is<sp/>&apos;field_resource_links&apos;<sp/>then<sp/>we<sp/>want<sp/>to</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>add<sp/>a<sp/>fieldset<sp/>of<sp/>tokens.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(isset($element[&apos;#field_name&apos;])<sp/>AND<sp/>$element[&apos;#field_name&apos;]<sp/>==<sp/>&apos;field_resource_links&apos;)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>Add<sp/>the<sp/>tokens<sp/>fieldset<sp/>to<sp/>the<sp/>last<sp/>element.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>$num_elements<sp/>=<sp/>count($context[&apos;items&apos;]);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>($num_elements<sp/>==<sp/>$element[&apos;#delta&apos;])<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$bundle<sp/>=<sp/>$element[&apos;#bundle&apos;];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$base_table<sp/>=<sp/>preg_replace(&apos;/^chado_(.*)$/&apos;,<sp/>&apos;\1&apos;,<sp/>$bundle);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$tokens<sp/>=<sp/>chado_node_generate_tokens($base_table);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$token_list<sp/>=<sp/>chado_node_format_tokens($tokens);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$element[&apos;tokens&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#type&apos;<sp/>=&gt;<sp/>&apos;fieldset&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#title&apos;<sp/>=&gt;<sp/>&apos;Available<sp/>tokens&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#collapsible&apos;<sp/>=&gt;<sp/>TRUE,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#collapsed&apos;<sp/>=&gt;<sp/>TRUE,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#weight&apos;<sp/>=&gt;<sp/>100</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$element[&apos;tokens&apos;][&apos;tokens_table&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#type&apos;<sp/>=&gt;<sp/>&apos;item&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#markup&apos;<sp/>=&gt;<sp/>$token_list</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_block_info().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_block_info()<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$blocks[&apos;tripal_search&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;info&apos;<sp/>=&gt;<sp/>t(&apos;Tripal<sp/>Search<sp/>Block&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;cache&apos;<sp/>=&gt;<sp/>DRUPAL_NO_CACHE,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>$blocks;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_block_view().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_block_view($delta<sp/>=<sp/>&apos;&apos;)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$block<sp/>=<sp/>array();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>switch<sp/>($delta)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>case<sp/>&apos;tripal_search&apos;:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$block[&apos;title&apos;]<sp/>=<sp/>&apos;Search&apos;;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$form_render_arr<sp/>=<sp/>drupal_get_form(&apos;tripal_core_search_block&apos;);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$block[&apos;content&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;#markup&apos;<sp/>=&gt;<sp/>drupal_render($form_render_arr),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>break;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>$block;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>A<sp/>simple<sp/>search<sp/>box<sp/>form.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_search_block($form,<sp/>$form_state)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form[&apos;wrapper&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#prefix&apos;<sp/>=&gt;<sp/>&apos;&lt;div<sp/>id=&quot;search-block-form&quot;<sp/>class=&quot;container-inline&quot;&gt;&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#suffix&apos;<sp/>=&gt;<sp/>&apos;&lt;/div&gt;&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form[&apos;wrapper&apos;][&apos;title&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#markup&apos;<sp/>=&gt;<sp/>&apos;&lt;h2<sp/>class=&quot;element-invisible&quot;&gt;Search<sp/>form&lt;/h2&gt;&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form[&apos;wrapper&apos;][&apos;search_block_form&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#title&apos;<sp/>=&gt;<sp/>&apos;Search&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#title_display&apos;<sp/>=&gt;<sp/>&apos;invisible&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#type&apos;<sp/>=&gt;<sp/>&apos;textfield&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#size&apos;<sp/>=&gt;<sp/>15,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#maxlength&apos;<sp/>=&gt;<sp/>128,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#attributes&apos;<sp/>=&gt;array(&apos;placeholder&apos;<sp/>=&gt;<sp/>t(variable_get(&apos;tripal_search_placeholder&apos;,<sp/>&apos;Keywords&apos;)))</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form[&apos;wrapper&apos;][&apos;submit&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#type&apos;<sp/>=&gt;<sp/>&apos;submit&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#value&apos;<sp/>=&gt;<sp/>&apos;Search&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#prefix&apos;<sp/>=&gt;<sp/>&apos;&lt;div<sp/>class=&quot;form-actions<sp/>form-wrapper&quot;<sp/>id=&quot;edit-actions&quot;&gt;&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#suffix&apos;<sp/>=&gt;<sp/>&apos;&lt;/div&gt;&apos;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form[&apos;search_placeholder&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#type&apos;<sp/>=&gt;<sp/>&apos;textfield&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#title&apos;<sp/>=&gt;<sp/>&apos;Placeholder<sp/>Text&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#description&apos;<sp/>=&gt;<sp/>&apos;Change<sp/>the<sp/>text<sp/>that<sp/>shows<sp/>up<sp/>within<sp/>the<sp/>search<sp/>box<sp/>until<sp/>the<sp/>user<sp/>enters<sp/>any<sp/>of<sp/>their<sp/>own<sp/>text.&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#default_value&apos;<sp/>=&gt;<sp/>variable_get(&apos;tripal_search_placeholder&apos;,<sp/>&apos;Keywords&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>$form;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Submit<sp/>for<sp/>tripal_core_search_block<sp/>form.</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_search_block_submit($form,<sp/>&amp;$form_state)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form_state[&apos;redirect&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>variable_get(&apos;tripal_search_block_url&apos;,<sp/>&apos;search/data&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&apos;query&apos;<sp/>=&gt;<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;keywords&apos;<sp/>=&gt;<sp/>$form_state[&apos;values&apos;][&apos;search_block_form&apos;]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_block_configure().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_block_configure<sp/>($delta<sp/>=<sp/>&apos;&apos;)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form<sp/>=<sp/>array();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>$form[&apos;search_url&apos;]<sp/>=<sp/>array(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#type&apos;<sp/>=&gt;<sp/>&apos;textfield&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#title&apos;<sp/>=&gt;<sp/>&apos;Search<sp/>Page<sp/>URL&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#description&apos;<sp/>=&gt;<sp/>&apos;The<sp/>URL<sp/>for<sp/>the<sp/>page<sp/>you<sp/>would<sp/>like<sp/>to<sp/>redirect<sp/>to<sp/>when<sp/>the<sp/>user</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clicks<sp/>&quot;Search&quot;.<sp/>It<sp/>is<sp/>expected<sp/>that<sp/>this<sp/>page<sp/>will<sp/>be<sp/>a<sp/>view<sp/>with<sp/>an<sp/>exposed</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filter<sp/>having<sp/>a<sp/>&quot;Filter<sp/>Identifier&quot;<sp/>(in<sp/>&quot;More&quot;<sp/>fieldset<sp/>on<sp/>the<sp/>edit<sp/>filter<sp/>form)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>&quot;keywords&quot;.&apos;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&apos;#default_value&apos;<sp/>=&gt;<sp/>variable_get(&apos;tripal_search_block_url&apos;,<sp/>&apos;search/data&apos;),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>return<sp/>$form;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">/**</highlight></codeline>
<codeline><highlight class="normal"><sp/>*<sp/>Implements<sp/>hook_block_save().</highlight></codeline>
<codeline><highlight class="normal"><sp/>*/</highlight></codeline>
<codeline><highlight class="normal">function<sp/>tripal_core_block_save($delta<sp/>=<sp/>&apos;&apos;,<sp/>$edit<sp/>=<sp/>array())<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>We<sp/>simply<sp/>want<sp/>to<sp/>save<sp/>this<sp/>information<sp/>in<sp/>a<sp/>Drupal<sp/>variable<sp/>for<sp/>use<sp/>in<sp/>the<sp/>form<sp/>submit.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(!empty($edit[&apos;search_url&apos;]))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>variable_set(&apos;tripal_search_block_url&apos;,<sp/>$edit[&apos;search_url&apos;]);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(!empty($edit[&apos;search_placeholder&apos;]))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>variable_set(&apos;tripal_search_placeholder&apos;,<sp/>$edit[&apos;search_placeholder&apos;]);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="legacy/tripal_core/tripal_core.module"/>
  </compounddef>
</doxygen>
